<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
* 코디 Mybatis mapper xml
* @author 김지현
* @since 2024.09.03
* @version 1.0
*
* <pre>
* 수정일        	수정자        수정내용
* ==========  =========    =======================
* 2024.09.03  	김지현        최초 생성
* </pre>
-->
<mapper namespace="com.oasis.hworld.coordination.mapper.CoordinationMapper">
    <!-- 코디 추가 -->
    <insert id="insertCoordination" useGeneratedKeys="true" keyProperty="coordinationId">
        <selectKey keyProperty="coordinationId" resultType="int" order="BEFORE">
            SELECT SEQ_COORDINATION.NEXTVAL FROM dual
        </selectKey>
        <![CDATA[
            INSERT INTO COORDINATION (coordination_id, member_id, title, image_url)
            VALUES (#{coordinationId}, #{memberId}, #{title}, #{imageUrl})
        ]]>
    </insert>

    <!-- 코디 아이템 추가 -->
    <insert id="insertCoordinationItem">
        <![CDATA[
            INSERT INTO COORDINATION_ITEM (category_id, coordination_id, item_option_id)
            VALUES (
                (SELECT category_id
                 FROM ITEM I
                     INNER JOIN ITEM_OPTION IO ON I.item_id = IO.item_id
                 WHERE IO.item_option_id = #{itemOptionId}),
                #{coordinationId},
                #{itemOptionId}
            )
        ]]>
    </insert>
</mapper>